# 🎯 PUBG 迫击炮辅助工具

一款 Windows 桌面应用程序，根据水平距离和仰角计算 PUBG 中迫击炮的距离设置。

## ✨ 功能特点

- 🖱️ 全局热键支持 - 游戏内也能使用
- 📐 利用游戏地图网格自动校准比例尺
- 📏 水平距离测量
- 📐 仰角检测
- 🧮 基于物理公式的迫击炮距离计算
- 🌙 现代深色主题界面

## 🚀 快速开始

### 系统要求

- Windows 10/11
- .NET 10.0 运行时
- **必须以管理员身份运行**（否则游戏内热键无法工作）

### 安装步骤

1. 下载最新版本
2. 解压到任意文件夹
3. **右键 → 以管理员身份运行**

## 🎮 使用方法

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| **Alt+Q** | 开始测量 / 关闭提示（如果提示窗口存在） |
| **Ctrl+Alt+Q** | 完整测量（重置比例尺） |
| **Alt+左键** | 设置测量点 |

### 测量步骤

1. **开始测量** - 按下 `Alt+Q`
2. **设置比例尺**（仅首次）- 在地图上点击 100 米网格线的两端
3. **设置你的位置** - 在地图上点击你的位置
4. **设置目标位置** - 在地图上点击目标位置
5. **获取仰角** - 在游戏中瞄准目标后点击
6. **读取结果** - 将迫击炮设置为显示的距离
7. **关闭/继续** - 按 `Alt+Q` 关闭提示或开始下一次测量

> 💡 **提示**：首次测量后，`Alt+Q` 会跳过比例尺设置，使用上次的校准值。如需重新校准（例如改变了地图缩放级别），请使用 `Ctrl+Alt+Q`。

## 🔬 工作原理

### 1. 比例尺校准 📏

程序通过地图的 100 米网格将像素距离转换为游戏实际米数：

```
比例尺系数 = 100米 / 像素距离
```

通过在 100 米网格线上点击两点，我们建立当前地图缩放级别的转换比率。

### 2. 水平距离计算 📐

校准后，任意两点之间的水平距离为：

```
距离（米）= 像素距离 × 比例尺系数
```

### 3. 仰角检测 🎯

这是最巧妙的部分！当你在 PUBG 中瞄准目标时：

- **屏幕中心**（1440p 下 Y = 719 像素）= **0° 仰角**（平视）
- **屏幕顶部**（Y = 0）= **+26.19° 仰角**（抬头看）
- **屏幕底部** = **负仰角**（低头看）

计算公式：
```
仰角 = (中心Y - 点击Y) × 最大角度 / 中心Y
```

这个方法巧妙地捕获了你和目标之间的高度差。

### 4. 迫击炮距离公式 🧮

迫击炮遵循抛物线弹道物理。当存在高度差时，需要进行补偿：

$$R = \frac{L + \tan(\beta) \cdot (M - \sqrt{M^2 - 2LM\tan(\beta) - L^2})}{\tan^2(\beta) + 1}$$

其中：
- **R** = 迫击炮距离设置（我们要求的值）
- **L** = 到目标的水平距离
- **β** = 仰角
- **M** = 迫击炮最大射程（700米）

当目标在同一水平面上（β = 0°）时，R 直接等于 L。

## ⚠️ 重要说明

### 分辨率与 FOV

默认校准值适用于：
- 分辨率：**2560 × 1440**
- 默认游戏 FOV

如果你使用不同的分辨率，可能需要在代码中调整 `CenterPixelY` 和 `MAX_DEGREE` 的值。

### 管理员权限

应用程序**必须以管理员身份运行**，原因如下：
- PUBG 以提升的权限运行
- Windows 会阻止低权限进程的输入钩子
- 没有管理员权限，游戏内热键将无法工作

## 🛠️ 技术栈

- **框架**：.NET 10.0 / WPF
- **架构**：MVVM（使用 CommunityToolkit.Mvvm）
- **热键**：H.Hooks 库实现全局键盘/鼠标钩子

## 📝 许可证

BSD 3-Clause 许可证 - 随意使用和修改！

## 🤝 贡献

欢迎提交 Issue 和 PR！如果你找到了其他分辨率的校准值，请分享给大家。

---

用 ❤️ 为 PUBG 玩家打造，让每一发迫击炮都精准命中！💥
