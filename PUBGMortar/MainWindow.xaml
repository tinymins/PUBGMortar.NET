<Window x:Class="PUBGMortar.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:PUBGMortar.ViewModels"
        mc:Ignorable="d"
        Title="PUBG 迫击炮辅助"
        Height="420"
        Width="360"
        MinHeight="400"
        MinWidth="340"
        WindowStartupLocation="CenterScreen"
        Topmost="True"
        Background="#1E1E1E"
        d:DataContext="{d:DesignInstance vm:MainViewModel}">

    <Window.Resources>
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#2D2D2D"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <Style x:Key="AccentButton" TargetType="Button">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1E8AD4"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#006CBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="#3D3D3D"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#4D4D4D"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#2D2D2D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="BadgeStyle" TargetType="Border">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <StackPanel>
            <!-- 标题 -->
            <TextBlock Text="🎯 PUBG 迫击炮辅助"
                       FontSize="20"
                       FontWeight="Bold"
                       Foreground="White"
                       Margin="0,0,0,16"/>

            <!-- 状态显示 -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <Grid>
                        <TextBlock Text="测量状态" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                        <Border Style="{StaticResource BadgeStyle}" HorizontalAlignment="Right"
                                Background="{Binding IsListening, Converter={StaticResource BoolToBrushConverter}}">
                            <TextBlock Text="{Binding StatusText}" Foreground="White" FontSize="11"/>
                        </Border>
                    </Grid>

                    <!-- 主结果 -->
                    <StackPanel Margin="0,16,0,0">
                        <TextBlock Text="迫击炮距离" FontSize="11" Foreground="#888"/>
                        <TextBlock Text="{Binding ResultText}"
                                   FontSize="36"
                                   FontWeight="Bold"
                                   Foreground="#0078D4"/>
                    </StackPanel>

                    <!-- 详细数据 -->
                    <Grid Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Background="#252525" CornerRadius="6" Padding="12,8">
                            <StackPanel>
                                <TextBlock Text="水平距离" FontSize="10" Foreground="#666"/>
                                <TextBlock Text="{Binding HorizontalDistanceText}"
                                           FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2" Background="#252525" CornerRadius="6" Padding="12,8">
                            <StackPanel>
                                <TextBlock Text="仰角" FontSize="10" Foreground="#666"/>
                                <TextBlock Text="{Binding ElevationAngleText}"
                                           FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- 控制按钮 -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,16">
                <Button Content="{Binding IsListening, Converter={StaticResource BoolToListenTextConverter}}"
                        Command="{Binding ToggleListeningCommand}"
                        Style="{StaticResource AccentButton}"/>
                <Button Content="重置"
                        Command="{Binding ResetMeasurementCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Margin="12,0,0,0"/>
            </StackPanel>

            <!-- 操作说明 -->
            <Border Style="{StaticResource CardStyle}" Margin="0">
                <StackPanel>
                    <TextBlock Text="快捷键" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,12"/>

                    <Grid Margin="0,0,0,6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Background="#00A86B" CornerRadius="4" Padding="8,4" Margin="0,0,12,0">
                            <TextBlock Text="Alt+Q" Foreground="White" FontSize="11" FontWeight="Bold"/>
                        </Border>
                        <TextBlock Grid.Column="1" Text="测量/关闭提示" Foreground="White" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Background="#D4A000" CornerRadius="4" Padding="8,4" Margin="0,0,12,0">
                            <TextBlock Text="Ctrl+Alt+Q" Foreground="Black" FontSize="11" FontWeight="Bold"/>
                        </Border>
                        <TextBlock Grid.Column="1" Text="重置比例尺并测量" Foreground="White" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Background="#D4A000" CornerRadius="4" Padding="8,4" Margin="0,0,12,0">
                            <TextBlock Text="Alt+左键" Foreground="Black" FontSize="11" FontWeight="Bold"/>
                        </Border>
                        <TextBlock Grid.Column="1" Text="设置点位" Foreground="White" VerticalAlignment="Center"/>
                    </Grid>

                    <TextBlock Text="测量步骤:" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,4"/>
                    <TextBlock TextWrapping="Wrap" Foreground="#AAA" FontSize="11" LineHeight="18"
                               Text="1. Alt+Q开始测量 (有提示则关闭)&#x0a;2. 首次自动设置100m比例尺&#x0a;3. 点击你的位置和目标位置&#x0a;4. 瞄准目标后点击获取仰角&#x0a;5. 查看结果设置迫击炮&#x0a;6. Alt+Q关闭提示或继续下一次&#x0a;7. Ctrl+Alt+Q可重置比例尺"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</Window>
